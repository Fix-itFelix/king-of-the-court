<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>King of the Court</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@800&display=swap"
      rel="stylesheet"
    />
    <style>
      #timer {
        font-size: 5rem;
      }
      body {
        font-family: "League Spartan", sans-serif;
        font-weight: bold;
        text-transform: uppercase;
      }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <h1 id="king-of-the-court-h1" class="text-center">
        üëë <i>KING OF THE COURT</i> üèê
      </h1>
      <button
        id="start-configuration-button"
        class="btn btn-primary mt-3"
        onclick="startConfiguration()"
      >
        CONFIGURE TEAMS
      </button>

      <div id="teams-form" style="display: none">
        <h2 class="mt-3">CONFIGURE TEAMS</h2>
        <form id="team-form">
          <div class="row">
            <!-- Team King -->
            <div class="col-md-5">
              <div class="mb-3">
                <label for="king-name" class="form-label">KING</label>
                <input
                  type="text"
                  class="form-control"
                  id="king-name"
                  placeholder="Team name"
                  required
                />
              </div>
            </div>
            <div class="col-md-1">
              <div class="mb-3">
                <label for="king-color" class="form-label">COLOR</label>
                <input
                  type="color"
                  class="form-control form-control-color"
                  id="king-color"
                  value="#cc0000"
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="king-player1" class="form-label">PLAYER 1</label>
                <input
                  type="text"
                  class="form-control"
                  id="king-player1"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="king-player2" class="form-label">PLAYER 2</label>
                <input
                  type="text"
                  class="form-control"
                  id="king-player2"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
          </div>

          <!-- Team Challenger -->
          <div class="row">
            <div class="col-md-5">
              <div class="mb-3">
                <label for="challenger-name" class="form-label"
                  >CHALLENGER</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="challenger-name"
                  placeholder="Team name"
                  required
                />
              </div>
            </div>
            <div class="col-md-1">
              <div class="mb-3">
                <label for="challenger-color" class="form-label">COLOR</label>
                <input
                  type="color"
                  class="form-control form-control-color"
                  id="challenger-color"
                  value="#8fce00"
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="challenger-player1" class="form-label"
                  >PLAYER 1</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="challenger-player1"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="challenger-player2" class="form-label"
                  >PLAYER 2</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="challenger-player2"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
          </div>

          <!-- Team First in Queue -->
          <div class="row">
            <div class="col-md-5">
              <div class="mb-3">
                <label for="first-in-queue-name" class="form-label"
                  >FIRST IN QUEUE</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="first-in-queue-name"
                  placeholder="Team name"
                  required
                />
              </div>
            </div>
            <div class="col-md-1">
              <div class="mb-3">
                <label for="first-in-queue-color" class="form-label"
                  >COLOR</label
                >
                <input
                  type="color"
                  class="form-control form-control-color"
                  id="first-in-queue-color"
                  value="#faff00"
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="first-in-queue-player1" class="form-label"
                  >PLAYER 1</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="first-in-queue-player1"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="first-in-queue-player2" class="form-label"
                  >PLAYER 2</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="first-in-queue-player2"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
          </div>

          <!-- Team Middle in Queue -->
          <div class="row">
            <div class="col-md-5">
              <div class="mb-3">
                <label for="middle-in-queue-name" class="form-label"
                  >MIDDLE IN QUEUE</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="middle-in-queue-name"
                  placeholder="Team name"
                  required
                />
              </div>
            </div>
            <div class="col-md-1">
              <div class="mb-3">
                <label for="middle-in-queue-color" class="form-label"
                  >COLOR</label
                >
                <input
                  type="color"
                  class="form-control form-control-color"
                  id="middle-in-queue-color"
                  value="#2f7ec5"
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="middle-in-queue-player1" class="form-label"
                  >PLAYER 1</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="middle-in-queue-player1"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="middle-in-queue-player2" class="form-label"
                  >PLAYER 2</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="middle-in-queue-player2"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
          </div>

          <!-- Team Last in Queue -->
          <div class="row">
            <div class="col-md-5">
              <div class="mb-3">
                <label for="last-in-queue-name" class="form-label"
                  >LAST IN QUEUE</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="last-in-queue-name"
                  placeholder="Team name"
                  required
                />
              </div>
            </div>
            <div class="col-md-1">
              <div class="mb-3">
                <label for="last-in-queue-color" class="form-label"
                  >COLOR</label
                >
                <input
                  type="color"
                  class="form-control form-control-color"
                  id="last-in-queue-color"
                  value="#000000"
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="last-in-queue-player1" class="form-label"
                  >PLAYER 1</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="last-in-queue-player1"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
            <div class="col-md-3">
              <div class="mb-3">
                <label for="last-in-queue-player2" class="form-label"
                  >PLAYER 2</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="last-in-queue-player2"
                  placeholder="Name"
                  required
                />
              </div>
            </div>
          </div>

          <button type="button" class="btn btn-primary" onclick="startGame()">
            START GAME
          </button>
        </form>
        <div id="validation-message" class="text-danger"></div>
      </div>

      <div id="teams-overview" style="display: none">
        <div id="teams-game-state-overview" class="row">
          <div class="col-md-4">
            <div class="card border-warning">
              <div class="card-body">
                <h4 class="card-title"><i>KING</i> üëë</h4>
                <p
                  style="padding-left: 3%"
                  class="card-text"
                  id="king-pane"
                ></p>
                <button
                  class="btn btn-success"
                  onclick="kingScored()"
                  data-bs-toggle="tooltip"
                  data-bs-placement="bottom"
                  title="Shortcut: K"
                >
                  KING SCORED
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card">
              <div class="card-body">
                <h4 style="font-style: italic" class="card-title">
                  CHALLENGER
                </h4>
                <p
                  style="padding-left: 3%"
                  class="card-text"
                  id="challenger-pane"
                ></p>
                <button
                  class="btn btn-success"
                  onclick="challengerScored()"
                  data-bs-toggle="tooltip"
                  data-bs-placement="bottom"
                  title="Shortcut: C"
                >
                  CHALLENGER SCORED
                </button>
                <button
                  class="btn btn-danger"
                  onclick="challengerFault()"
                  data-bs-toggle="tooltip"
                  data-bs-placement="bottom"
                  title="Shortcut: F"
                >
                  SERVICE FAULT
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card">
              <div class="card-body">
                <h4 style="font-style: italic" class="card-title">QUEUE</h4>
                <p
                  style="padding-left: 3%"
                  class="card-text"
                  id="queue-pane-first"
                ></p>
                <p
                  style="padding-left: 3%"
                  class="card-text"
                  id="queue-pane-middle"
                ></p>
                <p
                  style="padding-left: 3%"
                  class="card-text"
                  id="queue-pane-last"
                ></p>
              </div>
            </div>
          </div>
        </div>
        <!-- Timer -->
        <div class="card mt-3">
          <div class="card-body">
            <h4 style="font-style: italic" id="timer-title" class="card-title">
              TIMER
            </h4>
            <p style="font-weight: bold; font-style: italic" id="timer">
              15:00
            </p>
            <button
              id="pauseResumeBtn"
              class="btn btn-primary"
              onclick="pauseResumeTimer()"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              title="Shortcut: P"
              style="font-weight: bold; font-style: italic"
            >
              START ROUND 1
            </button>
          </div>
        </div>
        <!-- Leaderboard Card -->
        <div class="card mt-3">
          <div class="card-body">
            <h4 style="font-style: italic" class="card-title">LEADERBOARD</h4>
            <table id="leaderboardTable" class="table table-bordered">
              <thead>
                <tr>
                  <th>RANK</th>
                  <th>TEAM</th>
                  <th>PLAYERS</th>
                  <th>SCORE</th>
                  <th>STREAK</th>
                </tr>
              </thead>
              <tbody>
                <!-- Table body will be filled by the updateLeaderboard function -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <footer id="footer" class="footer fixed-bottom p-3">
      <div class="container text-center">
        <p class="mb-0">Made with ‚ù§Ô∏è by Fix-it Felix</p>
      </div>
    </footer>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      var king;
      var challenger;
      var first;
      var middle;
      var last;
      var teams;
      var serviceFaultCounter = 0;
      var intervalId;

      function startConfiguration() {
        document.getElementById("teams-form").style.display = "block";
        document.getElementById("start-configuration-button").style.display =
          "none";
      }

      function startGame() {
        // Check if all required input fields have values
        const requiredFields = document.querySelectorAll(
          "#team-form input[required]"
        );
        let allFieldsFilled = true;

        requiredFields.forEach((field) => {
          if (!field.value.trim()) {
            allFieldsFilled = false;
            // Highlight the field that needs attention (you can customize this part)
            field.classList.remove("is-valid");
            field.classList.add("is-invalid");
          } else {
            field.classList.remove("is-invalid");
            field.classList.add("is-valid");
          }
        });

        if (!allFieldsFilled) {
          // Display a message
          document.getElementById("validation-message").innerText =
            "Please fill in all team information before starting the game.";
          return;
        }

        document.addEventListener("keydown", function (event) {
          // Check if the key pressed is "p"
          if (event.key.toLowerCase() === "p") {
            pauseResumeTimer();
          }

          // Check if the key pressed is "k"
          if (event.key.toLowerCase() === "k") {
            kingScored();
          }

          // Check if the key pressed is "c"
          if (event.key.toLowerCase() === "c") {
            challengerScored();
          }

          // Check if the key pressed is "f"
          if (event.key.toLowerCase() === "f") {
            challengerFault();
          }
        });

        // Retrieve values from inputs
        const kingName = document.getElementById("king-name").value;
        const kingPlayer1 = document.getElementById("king-player1").value;
        const kingPlayer2 = document.getElementById("king-player2").value;
        const kingColor = document.getElementById("king-color").value;

        const challengerName = document.getElementById("challenger-name").value;
        const challengerPlayer1 =
          document.getElementById("challenger-player1").value;
        const challengerPlayer2 =
          document.getElementById("challenger-player2").value;
        const challengerColor =
          document.getElementById("challenger-color").value;

        const firstInQueueName = document.getElementById(
          "first-in-queue-name"
        ).value;
        const firstinqueuePlayer1 = document.getElementById(
          "first-in-queue-player1"
        ).value;
        const firstinqueuePlayer2 = document.getElementById(
          "first-in-queue-player2"
        ).value;
        const firstInQueueColor = document.getElementById(
          "first-in-queue-color"
        ).value;

        const middleInQueueName = document.getElementById(
          "middle-in-queue-name"
        ).value;
        const middleinqueuePlayer1 = document.getElementById(
          "middle-in-queue-player1"
        ).value;
        const middleinqueuePlayer2 = document.getElementById(
          "middle-in-queue-player2"
        ).value;
        const middleInQueueColor = document.getElementById(
          "middle-in-queue-color"
        ).value;

        const lastInQueueName =
          document.getElementById("last-in-queue-name").value;
        const lastinqueuePlayer1 = document.getElementById(
          "last-in-queue-player1"
        ).value;
        const lastinqueuePlayer2 = document.getElementById(
          "last-in-queue-player2"
        ).value;
        const lastInQueueColor = document.getElementById(
          "last-in-queue-color"
        ).value;

        // Create team objects with initial parameters
        const team1 = {
          name: kingName,
          player1: kingPlayer1,
          player2: kingPlayer2,
          score: 0,
          currentStreak: 0,
          longestStreak: 0,
          streakRanking: null,
          eliminated: false,
          eliminatedInRound: null,
          roundStartingPosition: 1,
          color: kingColor,
        };
        const team2 = {
          name: challengerName,
          player1: challengerPlayer1,
          player2: challengerPlayer2,
          score: 0,
          currentStreak: 0,
          longestStreak: 0,
          streakRanking: null,
          eliminated: false,
          eliminatedInRound: null,
          roundStartingPosition: 2,
          color: challengerColor,
        };
        const team3 = {
          name: firstInQueueName,
          player1: firstinqueuePlayer1,
          player2: firstinqueuePlayer2,
          score: 0,
          currentStreak: 0,
          longestStreak: 0,
          streakRanking: null,
          eliminated: false,
          eliminatedInRound: null,
          roundStartingPosition: 3,
          color: firstInQueueColor,
        };
        const team4 = {
          name: middleInQueueName,
          player1: middleinqueuePlayer1,
          player2: middleinqueuePlayer2,
          score: 0,
          currentStreak: 0,
          longestStreak: 0,
          streakRanking: null,
          eliminated: false,
          eliminatedInRound: null,
          roundStartingPosition: 4,
          color: middleInQueueColor,
        };
        const team5 = {
          name: lastInQueueName,
          player1: lastinqueuePlayer1,
          player2: lastinqueuePlayer2,
          score: 0,
          currentStreak: 0,
          longestStreak: 0,
          streakRanking: null,
          eliminated: false,
          eliminatedInRound: null,
          roundStartingPosition: 5,
          color: lastInQueueColor,
        };

        king = team1;
        challenger = team2;
        first = team3;
        middle = team4;
        last = team5;

        teams = [team1, team2, team3, team4, team5];

        // Display teams overview
        updateOverview();

        document.getElementById("start-configuration-button").style.display =
          "none";
        document.getElementById("teams-form").style.display = "none";
        document.getElementById("teams-overview").style.display = "block";
        document.getElementById("king-of-the-court-h1").style.display = "none";
        document.getElementById("footer").style.display = "none";

        updateLeaderboard();
      }

      function updateOverview() {
        // Display teams overview
        document.getElementById(
          "king-pane"
        ).innerText = `${king.name}\nPlayers: ${king.player1} & ${king.player2}\nScore: ${king.score}\nCurrent Streak: ${king.currentStreak}`;
        document.getElementById(
          "king-pane"
        ).style.borderLeft = `2vw solid ${king.color}`;
        document.getElementById(
          "challenger-pane"
        ).innerText = ` ${challenger.name}\nPlayers: ${challenger.player1} & ${challenger.player2}\nScore: ${challenger.score}\nService Fault Streak: ${serviceFaultCounter}`;
        document.getElementById(
          "challenger-pane"
        ).style.borderLeft = `2vw solid ${challenger.color}`;
        document.getElementById(
          "queue-pane-first"
        ).innerHTML = `${first.name}<br>Score: ${first.score}`;
        document.getElementById(
          "queue-pane-first"
        ).style.borderLeft = `2vw solid ${first.color}`;
        document.getElementById(
          "queue-pane-middle"
        ).innerHTML = `${middle.name}<br>Score: ${middle.score}`;
        document.getElementById(
          "queue-pane-middle"
        ).style.borderLeft = `2vw solid ${middle.color}`;
        document.getElementById(
          "queue-pane-last"
        ).innerHTML = `${last.name}<br>Score: ${last.score}`;
        document.getElementById(
          "queue-pane-last"
        ).style.borderLeft = `2vw solid ${last.color}`;
      }

      function kingScored() {
        pauseResumeTimer();
        serviceFaultCounter = 0;
        // Logic for when King scores
        king.score++;
        //Logic for streak
        king.currentStreak++;
        if (king.currentStreak > king.longestStreak) {
          king.streakRanking = 0;
          king.longestStreak = king.currentStreak;
          for (i = 0; i < teams.length; i++) {
            if (
              teams[i] != king &&
              king.longestStreak == teams[i].longestStreak
            ) {
              king.streakRanking++;
            }
          }
        }
        updateLeaderboard();
        if (king.score == 15 && round == 3) {
          clearInterval(intervalId);
          roundFinished();
        }
        var lostChallenger = challenger;
        // first in queue becomes challenger
        challenger = first;
        // queue is updated
        if (round == 1) {
          first = middle;
          middle = last;
          last = lostChallenger;
        } else if (round == 2) {
          first = middle;
          middle = lostChallenger;
        } else if (round == 3) {
          first = lostChallenger;
        }
        updateOverview();
      }

      function challengerScored() {
        pauseResumeTimer();
        serviceFaultCounter = 0;
        // King's current streak is reset
        king.currentStreak = 0;
        // Logic for when Challenger scores
        var lostKing = king;
        // challenger becomes new king
        king = challenger;
        // first in queue becomes challenger
        challenger = first;
        // queue is updated
        if (round == 1) {
          first = middle;
          middle = last;
          last = lostKing;
        } else if (round == 2) {
          first = middle;
          middle = lostKing;
        } else if (round == 3) {
          first = lostKing;
        }
        updateOverview();
      }

      function challengerFault() {
        pauseResumeTimer();
        serviceFaultCounter++;
        if (serviceFaultCounter == 3) {
          serviceFaultCounter = 0;
          king.score++;
          if (king.score == 15 && round == 3) {
            clearInterval(intervalId);
            roundFinished();
          }
          //Logic for streak
          king.currentStreak++;
          if (king.currentStreak > king.longestStreak) {
            king.streakRanking = 0;
            king.longestStreak = king.currentStreak;
            for (i = 0; i < teams.length; i++) {
              if (
                teams[i] != king &&
                king.longestStreak == teams[i].longestStreak
              ) {
                king.streakRanking++;
              }
            }
          }
          updateLeaderboard();
        }
        // Logic for when Challenger Service Fault
        var lostChallenger = challenger;
        // first in queue becomes challenger
        challenger = first;
        // queue is updated
        if (round == 1) {
          first = middle;
          middle = last;
          last = lostChallenger;
        } else if (round == 2) {
          first = middle;
          middle = lostChallenger;
        } else if (round == 3) {
          first = lostChallenger;
        }

        updateOverview();
      }

      let timerSeconds = 900; // 15 minutes in seconds
      let round = 1;
      let paused = false;

      function updateTimer() {
        const minutes = Math.floor(timerSeconds / 60);
        const seconds = timerSeconds % 60;
        const formattedTime = `${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;
        document.getElementById("timer").innerText = formattedTime;
      }

      function pauseResumeTimer() {
        if (
          document
            .getElementById("pauseResumeBtn")
            .innerText.includes("START ROUND")
        ) {
          if (round == 2) {
            document.getElementById("queue-pane-last").style.display = "none";
            serviceFaultCounter = 0;
            sortTeams();
            king = teams[0];
            king.score = 0;
            king.currentStreak = 0;
            king.longestStreak = 0;
            king.streakRanking = null;
            king.roundStartingPosition = 1;
            challenger = teams[1];
            challenger.score = 0;
            challenger.currentStreak = 0;
            challenger.longestStreak = 0;
            challenger.streakRanking = null;
            challenger.roundStartingPosition = 2;
            first = teams[2];
            first.score = 0;
            first.currentStreak = 0;
            first.longestStreak = 0;
            first.streakRanking = null;
            first.roundStartingPosition = 3;
            middle = teams[3];
            middle.score = 0;
            middle.currentStreak = 0;
            middle.longestStreak = 0;
            middle.streakRanking = null;
            middle.roundStartingPosition = 4;
            updateOverview();
            updateLeaderboard();
          } else if (round == 3) {
            document.getElementById("queue-pane-middle").style.display = "none";
            serviceFaultCounter = 0;
            sortTeams();
            king = teams[0];
            king.score = 0;
            king.currentStreak = 0;
            king.longestStreak = 0;
            king.streakRanking = null;
            king.roundStartingPosition = 1;
            challenger = teams[1];
            challenger.score = 0;
            challenger.currentStreak = 0;
            challenger.longestStreak = 0;
            challenger.streakRanking = null;
            challenger.roundStartingPosition = 2;
            first = teams[2];
            first.score = 0;
            first.currentStreak = 0;
            first.longestStreak = 0;
            first.streakRanking = null;
            first.roundStartingPosition = 3;
            updateOverview();
            updateLeaderboard();
          }
          document.getElementById("timer").innerText = "15:00";
          timerSeconds = 900;
          startTimer();
          document.getElementById("pauseResumeBtn").innerText = "PAUSE";
        } else {
          paused = !paused;
          const btnText = paused ? "RESUME" : "PAUSE";
          document.getElementById("pauseResumeBtn").innerText = btnText;
        }
      }

      function startTimer() {
        intervalId = setInterval(function () {
          if (!paused && timerSeconds > 0) {
            timerSeconds--;
            updateTimer();
          } else if (paused) {
            // do nothing
          } else {
            clearInterval(intervalId);
            roundFinished();
          }
        }, 1000);
      }

      function roundFinished() {
        if (round == 1) {
          eliminate(5);
          updateLeaderboard();
          round++;
          document.getElementById(
            "pauseResumeBtn"
          ).innerText = `Start round ${round}`;
        } else if (round == 2) {
          eliminate(4);
          updateLeaderboard();
          round++;
          document.getElementById(
            "pauseResumeBtn"
          ).innerText = `Start round ${round}`;
        } else if (round == 3) {
          eliminate(3);
          eliminate(2);
          updateLeaderboard();
          document.getElementById("timer").innerText = `Game finished`;
          document.getElementById("timer-title").style.display = "none";
          document.getElementById("pauseResumeBtn").style.display = "none";
          document.getElementById("teams-game-state-overview").style.display =
            "none";
          //TODO: show new page with leaderboard and option to restart game
        }
      }

      function eliminate(position) {
        // Sort teams based on score in ascending order
        sortTeams();

        // Find the team with the lowest score and eliminate it
        const lowestScoreTeam = teams[position - 1];
        lowestScoreTeam.eliminated = true;
        lowestScoreTeam.eliminatedInRound = round;
      }

      function sortTeams() {
        teams.sort((a, b) => {
          // Teams that are eliminated are placed at the end
          if (a.eliminated && !b.eliminated) {
            return 1;
          } else if (!a.eliminated && b.eliminated) {
            return -1;
          } else if (a.eliminated && b.eliminated) {
            // If both teams are eliminated, sort based on the round they were eliminated
            if (a.eliminatedInRound != b.eliminatedInRound) {
              return b.eliminatedInRound - a.eliminatedInRound;
            } else {
              return b.score - a.score;
            }
          }

          // Sort by score in descending order
          if (b.score !== a.score) {
            return b.score - a.score;
          }

          // If scores are tied, sort by streak in descending order
          if (b.longestStreak !== a.longestStreak) {
            return b.longestStreak - a.longestStreak;
          }

          // If streaks are tied, sort by streakRanking in ascending order
          if (a.streakRanking !== b.streakRanking) {
            return a.streakRanking - b.streakRanking;
          }

          // If streakRankings are tied, sort by roundStartingPosition in ascending order
          return a.roundStartingPosition - b.roundStartingPosition;
        });
      }

      function updateLeaderboard() {
        // Sort teams based on score in descending order
        sortTeams();

        const tableBody = document
          .getElementById("leaderboardTable")
          .getElementsByTagName("tbody")[0];
        tableBody.innerHTML = ""; // Clear existing rows

        for (let i = 0; i < teams.length; i++) {
          const team = teams[i];
          const row = tableBody.insertRow();

          // Rank column
          const rankCell = row.insertCell(0);
          rankCell.textContent = i + 1;

          // Team name column
          const teamCell = row.insertCell(1);
          teamCell.textContent = team.name;

          // Players column
          const playersCell = row.insertCell(2);
          playersCell.textContent = `${team.player1} & ${team.player2}`;

          // Score column
          const scoreCell = row.insertCell(3);
          scoreCell.textContent = team.score;

          // Longest Streak column
          const longestStreakCell = row.insertCell(4);
          longestStreakCell.textContent = team.longestStreak;

          // Apply styles based on elimination status
          if (team.eliminated) {
            row.classList.add("table-danger");
          } else if (i === 0) {
            // Highlight the top-ranked team
            row.classList.add("table-success");
          } else {
            row.classList.add("table-light");
          }
        }
      }
    </script>
  </body>
</html>
